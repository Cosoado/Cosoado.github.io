<!DOCTYPE html>
<html lang="ja">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-XXXXXXXXXX');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact | Cosoado Lab</title>
    <meta name="description" content="Cosoado Labへのお問い合わせはこちらから。AIプロダクト開発に関するご質問やご依頼を受け付けています。">

    <link rel="stylesheet" href="../style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700&family=Zen+Kaku+Gothic+New:wght@300;400;500;700&display=swap"
        rel="stylesheet">
    <link rel="icon" href="/favicon.png" type="image/png">
</head>

<body>
    <!-- Fluid Background Animation -->
    <div class="fluid-bg">
        <div class="blob"></div>
        <div class="blob"></div>
        <div class="blob"></div>
    </div>

    <!-- Custom Cursor -->
    <div class="cursor-dot"></div>
    <div class="cursor-outline"></div>

    <header class="header">
        <div class="container" style="display: flex; justify-content: space-between; width: 100%;">
            <a href="/" class="logo">
                <img src="../assets/logo_transparent.png" alt="Cosoado Lab" class="logo-image">
                <span class="logo-text">Cosoado Lab</span>
            </a>
            <!-- Simple Navigation if needed, or stick to minimalist -->
            <nav class="nav-links" style="display: flex; gap: 20px; align-items: center;">
                <!-- Ideally standardized nav should be here, but for now we just link back -->
                <a href="/" style="text-decoration: none; color: var(--text-primary); font-weight: 500;">Home</a>
            </nav>
        </div>
    </header>

    <main>
        <section class="section">
            <div class="container contact-container">
                <div class="contact-header" style="margin-top: 40px;">
                    <h1 class="hero-title" style="font-size: 3rem; margin-bottom: 1rem;">Contact Us</h1>
                    <p class="hero-subtitle" style="margin-bottom: 3rem;">
                        ご質問、ご依頼、その他お気軽にお問い合わせください。<br>
                        新しいアイデアやコラボレーションについてもお待ちしております。
                    </p>
                </div>

                <!-- Contact Form -->
                <div class="contact-card glass-panel">
                    <!-- Form action is set dynamically via JavaScript for security -->
                    <form id="contact-form" method="POST" class="contact-form">
                        <!-- Honeypot field for spam bot detection (hidden from users) -->
                        <input type="text" name="_gotcha" style="display:none !important" tabindex="-1"
                            autocomplete="off">

                        <div class="form-group">
                            <label for="name" class="form-label">Name</label>
                            <input type="text" id="name" name="name" class="form-input" required placeholder="お名前"
                                maxlength="100">
                        </div>

                        <div class="form-group">
                            <label for="email" class="form-label">Email</label>
                            <input type="email" id="email" name="email" class="form-input" required
                                placeholder="メールアドレス" maxlength="254">
                            <span id="email-error" class="form-error"></span>
                        </div>

                        <div class="form-group">
                            <label for="subject" class="form-label">Subject</label>
                            <input type="text" id="subject" name="subject" class="form-input" required placeholder="件名"
                                maxlength="200">
                        </div>

                        <div class="form-group">
                            <label for="message" class="form-label">Message</label>
                            <textarea id="message" name="message" class="form-textarea" required placeholder="お問い合わせ内容"
                                maxlength="5000"></textarea>
                        </div>

                        <div id="form-status" class="form-status"></div>

                        <button type="submit" class="submit-btn" id="submit-btn">
                            Send Message
                            <span class="btn-icon">→</span>
                        </button>
                    </form>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2026 Cosoado Lab. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="../script.js"></script>
    <script>
        // Security: Form endpoint obfuscation
        (function () {
            const form = document.getElementById('contact-form');
            const emailInput = document.getElementById('email');
            const emailError = document.getElementById('email-error');

            // Obfuscated form endpoint (Base64 encoded and split)
            const _0x1 = 'aHR0cHM6Ly9mb3Jtc3ByZWUu';
            const _0x2 = 'aW8vZi94amdr';
            const _0x3 = 'bGxlYg==';
            const _d = function (s) { return atob(s); };

            // Set form action dynamically
            form.setAttribute('action', _d(_0x1) + _d(_0x2) + _d(_0x3));

            const emailPattern = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;

            // Input sanitization function
            function sanitizeInput(str) {
                const div = document.createElement('div');
                div.textContent = str;
                return div.innerHTML;
            }

            function validateEmail() {
                if (!emailInput.value.match(emailPattern)) {
                    emailError.textContent = '有効なメールアドレスを入力してください';
                    emailError.style.display = 'block';
                    return false;
                } else {
                    emailError.textContent = '';
                    emailError.style.display = 'none';
                    return true;
                }
            }

            // Validate all inputs
            function validateAllInputs() {
                const name = document.getElementById('name').value;
                const subject = document.getElementById('subject').value;
                const message = document.getElementById('message').value;

                // Check for suspicious patterns (potential injection)
                const suspiciousPattern = /<script|javascript:|data:/i;
                if (suspiciousPattern.test(name) || suspiciousPattern.test(subject) || suspiciousPattern.test(message)) {
                    return false;
                }
                return true;
            }

            emailInput.addEventListener('blur', function () {
                if (this.value) validateEmail();
            });

            emailInput.addEventListener('input', function () {
                if (emailError.textContent) validateEmail();
            });

            form.addEventListener('submit', function (e) {
                // Honeypot check
                const honeypot = form.querySelector('input[name="_gotcha"]');
                if (honeypot && honeypot.value) {
                    e.preventDefault();
                    return;
                }

                if (!validateEmail() || !validateAllInputs()) {
                    e.preventDefault();
                    emailInput.focus();
                    emailInput.style.borderColor = '#ff6b6b';
                    setTimeout(() => {
                        emailInput.style.borderColor = 'rgba(255, 255, 255, 0.1)';
                    }, 2000);
                    return;
                }
            });

            // Clear form when returning from Formspree
            if (document.referrer && document.referrer.includes(_d('Zm9ybXNwcmVl'))) {
                form.reset();
            }

            // Clear form on browser back button
            window.addEventListener('pageshow', function (event) {
                if (event.persisted) {
                    form.reset();
                }
            });
        })();
    </script>
</body>

</html>